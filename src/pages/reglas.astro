---
import Layout from '../layouts/Layout.astro';
import { getRatingTier, getTierColor } from '../lib/elo';

// Definir los rangos de ELO
const tiers = [
  { name: 'Aldeano', min: 0, max: 999, icon: 'ğŸ ', color: 'text-gray-400', description: 'ReciÃ©n llegado a las colonias' },
  { name: 'Explorador', min: 1000, max: 1199, icon: 'ğŸ§­', color: 'text-green-400', description: 'Empezando a descubrir el mapa' },
  { name: 'Miliciano', min: 1200, max: 1399, icon: 'âš”ï¸', color: 'text-blue-400', description: 'Defensor de la metrÃ³poli' },
  { name: 'Veterano', min: 1400, max: 1599, icon: 'ğŸ›¡ï¸', color: 'text-purple-400', description: 'Soldado experimentado' },
  { name: 'Ã‰lite', min: 1600, max: 1799, icon: 'ğŸ–ï¸', color: 'text-yellow-400', description: 'Comandante reconocido' },
  { name: 'Imperial', min: 1800, max: 1999, icon: 'ğŸ‘‘', color: 'text-orange-400', description: 'LÃ­der del imperio' },
  { name: 'Leyenda', min: 2000, max: Infinity, icon: 'ğŸ†', color: 'text-aoe-gold', description: 'Su nombre pasarÃ¡ a la historia' },
];
---

<Layout title="Reglas y Sistema de Ranking">
  <div class="max-w-4xl mx-auto space-y-8">
    <div class="text-center">
      <h1 class="aoe-title text-3xl mb-2">Reglas y Sistema de Ranking</h1>
      <p class="text-aoe-cream-dark">Todo lo que necesitas saber sobre cÃ³mo funciona el tracker</p>
    </div>

    <!-- Sistema ELO -->
    <div class="aoe-panel">
      <h2 class="aoe-title text-xl mb-4 flex items-center gap-2">
        <span>ğŸ“Š</span> Sistema de PuntuaciÃ³n ELO
      </h2>
      <div class="space-y-4 text-aoe-cream-dark">
        <p>
          Utilizamos el <strong class="text-aoe-gold">Sistema ELO</strong>, el mismo sistema de rating usado en ajedrez
          y muchos juegos competitivos. Este sistema calcula tu habilidad relativa comparÃ¡ndola con otros jugadores.
        </p>

        <div class="aoe-card">
          <h3 class="text-aoe-gold font-semibold mb-2">Â¿CÃ³mo funciona?</h3>
          <ul class="list-disc list-inside space-y-2">
            <li>Todos los jugadores empiezan con <strong class="text-white">1000 puntos ELO</strong></li>
            <li>Ganar una partida te da puntos, perderla te quita puntos</li>
            <li>La cantidad de puntos depende de la diferencia de ELO entre jugadores</li>
            <li>Ganar contra alguien con mÃ¡s ELO te da mÃ¡s puntos</li>
            <li>Perder contra alguien con menos ELO te quita mÃ¡s puntos</li>
          </ul>
        </div>

        <div class="aoe-card">
          <h3 class="text-aoe-gold font-semibold mb-2">Factor K</h3>
          <p class="mb-2">
            El <strong class="text-white">Factor K = 32</strong> determina cuÃ¡nto pueden cambiar tus puntos en una partida.
          </p>
          <div class="grid grid-cols-2 gap-4 mt-3">
            <div class="bg-green-900/20 border border-green-500/30 rounded p-3">
              <p class="text-green-400 font-semibold">Victoria tÃ­pica</p>
              <p class="text-sm">+16 a +25 puntos</p>
            </div>
            <div class="bg-red-900/20 border border-red-500/30 rounded p-3">
              <p class="text-red-400 font-semibold">Derrota tÃ­pica</p>
              <p class="text-sm">-16 a -25 puntos</p>
            </div>
          </div>
        </div>

        <div class="aoe-card">
          <h3 class="text-aoe-gold font-semibold mb-2">ELO Separado por Modalidad</h3>
          <p>Cada tipo de partida tiene su propio ELO:</p>
          <div class="grid grid-cols-3 gap-3 mt-3">
            <div class="text-center p-3 bg-aoe-dark/50 rounded">
              <span class="text-2xl block mb-1">âš”ï¸</span>
              <span class="text-sm font-semibold">1v1</span>
              <p class="text-xs text-aoe-cream-dark/70">Duelos individuales</p>
            </div>
            <div class="text-center p-3 bg-aoe-dark/50 rounded">
              <span class="text-2xl block mb-1">âš”ï¸âš”ï¸</span>
              <span class="text-sm font-semibold">Equipos</span>
              <p class="text-xs text-aoe-cream-dark/70">2v2, 3v3, etc.</p>
            </div>
            <div class="text-center p-3 bg-aoe-dark/50 rounded">
              <span class="text-2xl block mb-1">ğŸ‘‘</span>
              <span class="text-sm font-semibold">FFA</span>
              <p class="text-xs text-aoe-cream-dark/70">Todos contra todos</p>
            </div>
          </div>
        </div>
      </div>
    </div>

    <!-- Rangos -->
    <div class="aoe-panel">
      <h2 class="aoe-title text-xl mb-4 flex items-center gap-2">
        <span>ğŸ–ï¸</span> Rangos
      </h2>
      <p class="text-aoe-cream-dark mb-4">
        Tu rango depende de tu puntuaciÃ³n ELO. Sube de rango ganando partidas.
      </p>

      <div class="space-y-3">
        {tiers.map(tier => (
          <div class="flex items-center gap-4 p-3 bg-aoe-dark/50 rounded border border-aoe-gold/10 hover:border-aoe-gold/30 transition-colors">
            <span class="text-3xl">{tier.icon}</span>
            <div class="flex-1">
              <div class="flex items-center gap-2">
                <span class={`font-cinzel font-bold ${tier.color}`}>{tier.name}</span>
                <span class="text-xs text-aoe-cream-dark/50">
                  {tier.max === Infinity ? `${tier.min}+` : `${tier.min} - ${tier.max}`}
                </span>
              </div>
              <p class="text-xs text-aoe-cream-dark/70">{tier.description}</p>
            </div>
          </div>
        ))}
      </div>
    </div>

    <!-- Reglas de Partidas -->
    <div class="aoe-panel">
      <h2 class="aoe-title text-xl mb-4 flex items-center gap-2">
        <span>ğŸ“œ</span> Reglas de Partidas
      </h2>
      <div class="space-y-4 text-aoe-cream-dark">
        <div class="aoe-card">
          <h3 class="text-aoe-gold font-semibold mb-2">1v1 (Duelo)</h3>
          <ul class="list-disc list-inside space-y-1 text-sm">
            <li>Dos jugadores se enfrentan directamente</li>
            <li>El ganador y el perdedor deben ser registrados</li>
            <li>Se usa la civilizaciÃ³n configurada en el perfil de cada jugador</li>
            <li>Afecta el ELO de 1v1</li>
          </ul>
        </div>

        <div class="aoe-card">
          <h3 class="text-aoe-gold font-semibold mb-2">2v2 / 3v3 (Equipos)</h3>
          <ul class="list-disc list-inside space-y-1 text-sm">
            <li>Equipos de 2 o 3 jugadores</li>
            <li>Todo el equipo ganador recibe puntos</li>
            <li>Todo el equipo perdedor pierde puntos</li>
            <li>Se puede usar el aleatorizador de equipos</li>
            <li>Afecta el ELO de Equipos</li>
          </ul>
        </div>

        <div class="aoe-card">
          <h3 class="text-aoe-gold font-semibold mb-2">FFA (Todos contra Todos)</h3>
          <ul class="list-disc list-inside space-y-1 text-sm">
            <li>MÃºltiples jugadores, cada uno por su cuenta</li>
            <li>Solo hay un ganador</li>
            <li>El ganador gana puntos contra todos los perdedores</li>
            <li>Los perdedores pierden puntos contra el ganador</li>
            <li>Afecta el ELO de FFA</li>
          </ul>
        </div>
      </div>
    </div>

    <!-- Herramientas -->
    <div class="aoe-panel">
      <h2 class="aoe-title text-xl mb-4 flex items-center gap-2">
        <span>ğŸ› ï¸</span> Herramientas Disponibles
      </h2>
      <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
        <a href="/ruleta" class="aoe-card hover:border-aoe-gold-light transition-all group">
          <div class="flex items-center gap-3">
            <span class="text-3xl">ğŸ²</span>
            <div>
              <h3 class="text-aoe-gold font-semibold group-hover:text-aoe-gold-light">Ruleta de Enfrentamientos</h3>
              <p class="text-sm text-aoe-cream-dark">Genera duelos aleatorios entre jugadores</p>
            </div>
          </div>
        </a>

        <a href="/head-to-head" class="aoe-card hover:border-aoe-gold-light transition-all group">
          <div class="flex items-center gap-3">
            <span class="text-3xl">âš”ï¸</span>
            <div>
              <h3 class="text-aoe-gold font-semibold group-hover:text-aoe-gold-light">Head-to-Head</h3>
              <p class="text-sm text-aoe-cream-dark">Compara historial entre dos jugadores</p>
            </div>
          </div>
        </a>

        <a href="/matches/new" class="aoe-card hover:border-aoe-gold-light transition-all group">
          <div class="flex items-center gap-3">
            <span class="text-3xl">ğŸ“</span>
            <div>
              <h3 class="text-aoe-gold font-semibold group-hover:text-aoe-gold-light">Registrar Partida</h3>
              <p class="text-sm text-aoe-cream-dark">Anota una nueva partida jugada</p>
            </div>
          </div>
        </a>

        <a href="/profile" class="aoe-card hover:border-aoe-gold-light transition-all group">
          <div class="flex items-center gap-3">
            <span class="text-3xl">ğŸ‘¤</span>
            <div>
              <h3 class="text-aoe-gold font-semibold group-hover:text-aoe-gold-light">Mi Perfil</h3>
              <p class="text-sm text-aoe-cream-dark">Configura tu civilizaciÃ³n favorita</p>
            </div>
          </div>
        </a>
      </div>
    </div>

    <!-- FAQ -->
    <div class="aoe-panel">
      <h2 class="aoe-title text-xl mb-4 flex items-center gap-2">
        <span>â“</span> Preguntas Frecuentes
      </h2>
      <div class="space-y-4">
        <details class="aoe-card cursor-pointer group">
          <summary class="text-aoe-gold font-semibold list-none flex justify-between items-center">
            Â¿Por quÃ© perdÃ­ mÃ¡s puntos de los que pensaba?
            <span class="text-aoe-cream-dark group-open:rotate-180 transition-transform">â–¼</span>
          </summary>
          <p class="mt-3 text-aoe-cream-dark text-sm">
            La cantidad de puntos que pierdes depende del ELO de tu oponente. Si pierdes contra
            alguien con menos ELO que tÃº, perderÃ¡s mÃ¡s puntos porque se esperaba que ganaras.
          </p>
        </details>

        <details class="aoe-card cursor-pointer group">
          <summary class="text-aoe-gold font-semibold list-none flex justify-between items-center">
            Â¿CÃ³mo se calcula el ELO en partidas de equipo?
            <span class="text-aoe-cream-dark group-open:rotate-180 transition-transform">â–¼</span>
          </summary>
          <p class="mt-3 text-aoe-cream-dark text-sm">
            En partidas de equipo, se calcula el ELO promedio de cada equipo. Luego, cada jugador
            gana o pierde puntos basÃ¡ndose en la diferencia entre los promedios de los equipos.
          </p>
        </details>

        <details class="aoe-card cursor-pointer group">
          <summary class="text-aoe-gold font-semibold list-none flex justify-between items-center">
            Â¿Puedo cambiar mi civilizaciÃ³n favorita?
            <span class="text-aoe-cream-dark group-open:rotate-180 transition-transform">â–¼</span>
          </summary>
          <p class="mt-3 text-aoe-cream-dark text-sm">
            SÃ­, puedes cambiar tu civilizaciÃ³n favorita en cualquier momento desde tu
            <a href="/profile" class="text-aoe-gold hover:underline">perfil</a>.
            Esta civilizaciÃ³n se usarÃ¡ automÃ¡ticamente cuando registres partidas.
          </p>
        </details>

        <details class="aoe-card cursor-pointer group">
          <summary class="text-aoe-gold font-semibold list-none flex justify-between items-center">
            Â¿QuiÃ©n puede registrar partidas?
            <span class="text-aoe-cream-dark group-open:rotate-180 transition-transform">â–¼</span>
          </summary>
          <p class="mt-3 text-aoe-cream-dark text-sm">
            Cualquier usuario registrado puede registrar partidas. Sin embargo, solo el administrador
            puede crear jugadores invitados (usuarios que no se han registrado por su cuenta).
          </p>
        </details>
      </div>
    </div>
  </div>
</Layout>
